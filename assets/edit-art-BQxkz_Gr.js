import{w as l}from"./with-props-BUJaXTv7.js";import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{w as m,s as c,L as o,v as u}from"./chunk-DQRVZFIR-CGfc0zaK.js";import{b as p,u as f}from"./art-DyO3Qdz8.js";import{a as _}from"./arrow-CMmgFB8Y.js";import"./supabase-C7s_kt8r.js";const y=async a=>{const i=new FormData;i.append("file",a),i.append("upload_preset","media_upload_preset");const t=await fetch("https://api.cloudinary.com/v1_1/dngqj5iyc/auto/upload",{method:"POST",body:i});if(!t.ok)throw new Error("Upload failed");return await t.json()},x="/integration4/assets/edit_artwork-DTy1qLYR.svg";async function I({params:a}){return{art:await p(Number(a.id))}}async function k({request:a,params:i}){const t=await a.formData(),s=t.get("media");let r=t.get("existingUrl"),d=t.get("type");if(s&&s.name){r=(await y(s)).secure_url;const n=r.split(".").pop();["mp4","mov","webm"].includes(n)?d="video":["mp3","wav","ogg"].includes(n)?d="audio":d="image"}return await f({id:Number(i.id),title:t.get("title"),description:t.get("description"),url:r,type:d,artTypeId:Number(t.get("artTypeId")),eventId:Number(t.get("eventId")),userId:Number(t.get("userId")),visibility:t.get("visibility")==="true"},i.id),m("/my-gallery")}const T=l(function({loaderData:i}){const{art:t}=i,r=c().state==="submitting";return t?e.jsxs("main",{className:"edit-form",children:[e.jsx("h1",{className:"visually-hidden",children:"Edit Your Artwork"}),e.jsxs("div",{className:"edit-form__header",children:[e.jsxs(o,{to:"/my-gallery",className:"edit-form__back",children:[e.jsx("img",{src:_,alt:"Back arrow",className:"edit-form__arrow"}),"Back"]}),e.jsx("img",{src:x,alt:"edit_artwork",className:"edit_artwork"})]}),e.jsx("article",{children:e.jsxs(u,{method:"post",encType:"multipart/form-data",className:"edit-form__form",children:[e.jsx("input",{type:"hidden",name:"existingUrl",value:t.url}),e.jsx("input",{type:"hidden",name:"type",value:t.type}),e.jsx("input",{type:"hidden",name:"artTypeId",value:t.artTypeId}),e.jsx("input",{type:"hidden",name:"eventId",value:t.eventId}),e.jsx("input",{type:"hidden",name:"userId",value:t.userId}),e.jsx("input",{type:"hidden",name:"visibility",value:t.visibility}),r&&e.jsx("p",{className:"edit-form__uploading-message",children:"Uploading..."}),e.jsxs("div",{className:"edit-form__field",children:[e.jsx("label",{htmlFor:"title",className:"edit-form__label",children:"Title"}),e.jsx("input",{type:"text",id:"title",name:"title",defaultValue:t.title,className:"edit-form__input",required:!0})]}),e.jsxs("div",{className:"edit-form__field",children:[e.jsx("label",{htmlFor:"description",className:"edit-form__label",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",defaultValue:t.description,className:"edit-form__input",required:!0})]}),e.jsxs("div",{className:"edit-form__field",children:[e.jsx("label",{htmlFor:"media",className:"edit-form__label",children:"Replace File"}),e.jsx("input",{type:"file",id:"media",name:"media",accept:"image/*,audio/*,video/*",className:"edit-form__input"})]}),e.jsxs("div",{className:"edit-form__actions",children:[e.jsx("button",{type:"submit",className:"edit-form__button edit-form__button--primary",children:"Update"}),e.jsx(o,{to:"/my-gallery",className:"edit-form__button edit-form__button--secondary",children:"Cancel"})]})]})})]}):e.jsx("p",{children:"Artwork not found."})});export{k as clientAction,I as clientLoader,T as default};
